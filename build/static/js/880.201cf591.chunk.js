"use strict";(self.webpackChunkfundacion_todo_por_un_alma=self.webpackChunkfundacion_todo_por_un_alma||[]).push([[880],{6880:(e,a,s)=>{s.r(a),s.d(a,{default:()=>x});var i=s(5043),t=s(3474),r=s(4349),l=s(3324),o=s(3208),d=s(2144),n=s(1379),c=s(3714),m=s(579);const p=()=>{const[e,a]=(0,i.useState)([]),[s,p]=(0,i.useState)(!0),[x,u]=(0,i.useState)(null),b=(0,c.hS)(),f=(0,c.hS)(),h=(0,c.hS)(),g=async()=>{try{p(!0),u(null),console.log("\ud83d\udd04 Cargando sedes...");const e=await r.C5.getSedes();if(console.log("\ud83d\udcca Resultado sedes:",e),e.error)throw new Error(e.error.message||"Error al cargar sedes");const s=Array.isArray(e.data)?e.data:[];a(s),console.log("\u2705 Sedes cargadas:",s.length)}catch(e){console.error("\u274c Error cargando sedes:",e),u(e.message||"Error desconocido al cargar sedes"),a([])}finally{p(!1)}};(0,i.useEffect)(()=>{g()},[]);const v=(0,i.useMemo)(()=>Array.isArray(e)?e:[],[e]),N=(0,i.useMemo)(()=>[{title:"Total Sedes",value:v.length,icon:"fas fa-building",color:"blue"},{title:"Activas",value:v.filter(e=>"Activa"===e.estado).length,icon:"fas fa-check-circle",color:"green"},{title:"Inactivas",value:v.filter(e=>"Inactiva"===e.estado).length,icon:"fas fa-times-circle",color:"red"}],[v]);return s?(0,m.jsx)(t.A,{title:"Sedes",subtitle:"Gesti\xf3n de sedes",loading:!0,loadingText:"Cargando sedes..."}):x?(0,m.jsx)(t.A,{title:"Sedes",subtitle:"Error al cargar datos",loading:!1,children:(0,m.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,m.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:(0,m.jsxs)("p",{className:"text-red-600",children:["Error loading sedes: ",x]})})})}):(0,m.jsxs)(t.A,{title:"Gesti\xf3n de Sedes",subtitle:"Administra las sedes de la fundaci\xf3n",extraActions:(0,m.jsxs)("button",{onClick:()=>h.openModal(),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:[(0,m.jsx)("i",{className:"fas fa-plus mr-2"}),"Nueva Sede"]}),children:[(0,m.jsx)("div",{className:"px-6 py-4",children:(0,m.jsx)(l.MD,{stats:N,columns:3})}),(0,m.jsxs)("div",{className:"px-6 py-4",children:[(0,m.jsxs)("div",{className:"mb-6",children:[(0,m.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Lista de Sedes"}),(0,m.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Haz clic en una sede para ver m\xe1s detalles"})]}),0===v.length?(0,m.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center",children:[(0,m.jsx)("i",{className:"fas fa-building text-gray-300 text-4xl mb-4"}),(0,m.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No se encontraron sedes"}),(0,m.jsx)("p",{className:"text-gray-500",children:"No hay sedes que coincidan con los filtros aplicados."})]}):(0,m.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:v.map(e=>(0,m.jsx)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 hover:shadow-lg transition-all duration-200 cursor-pointer group",onClick:()=>{b.setData(e),b.openModal()},children:(0,m.jsxs)("div",{className:"p-6",children:[(0,m.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,m.jsxs)("div",{className:"flex items-center",children:[(0,m.jsx)("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mr-3",children:(0,m.jsx)("i",{className:"fas fa-building text-blue-600 text-lg"})}),(0,m.jsxs)("div",{children:[(0,m.jsx)("h3",{className:"text-lg font-semibold text-gray-900 group-hover:text-blue-600 transition-colors",children:e.nombre}),(0,m.jsx)("p",{className:"text-sm text-gray-500",children:e.tipo||"Principal"})]})]}),(0,m.jsx)("div",{onClick:e=>e.stopPropagation(),children:(0,m.jsx)(o.r,{currentStatus:e.estado,statuses:[{value:"Activa",label:"Activa",variant:"success"},{value:"Inactiva",label:"Inactiva",variant:"danger"}],onChange:s=>(async(e,s)=>{try{await r.C5.updateSede(e,{estado:s});const{data:i}=await r.C5.getSedes();a(i||[])}catch(i){console.error("Error updating status:",i)}})(e.id,s)})})]}),(0,m.jsxs)("div",{className:"space-y-3",children:[(0,m.jsxs)("div",{className:"flex items-start",children:[(0,m.jsx)("i",{className:"fas fa-map-marker-alt text-gray-400 mt-1 mr-3 flex-shrink-0"}),(0,m.jsx)("p",{className:"text-sm text-gray-600 line-clamp-2",children:e.direccion})]}),e.telefono&&(0,m.jsxs)("div",{className:"flex items-center",children:[(0,m.jsx)("i",{className:"fas fa-phone text-gray-400 mr-3 flex-shrink-0"}),(0,m.jsx)("p",{className:"text-sm text-gray-600",children:e.telefono})]}),e.capacidad_maxima&&(0,m.jsxs)("div",{className:"flex items-center",children:[(0,m.jsx)("i",{className:"fas fa-users text-gray-400 mr-3 flex-shrink-0"}),(0,m.jsxs)("p",{className:"text-sm text-gray-600",children:["Capacidad: ",e.capacidad_maxima," participantes"]})]})]}),(0,m.jsxs)("div",{className:"flex items-center justify-between mt-6 pt-4 border-t border-gray-100",children:[(0,m.jsxs)("button",{onClick:a=>{a.stopPropagation(),b.setData(e),b.openModal()},className:"flex items-center text-blue-600 hover:text-blue-800 text-sm font-medium transition-colors",children:[(0,m.jsx)("i",{className:"fas fa-eye mr-2"}),"Ver detalles"]}),(0,m.jsx)("div",{onClick:e=>e.stopPropagation(),children:(0,m.jsx)(d.yd,{actions:[{label:"Ver detalles",icon:"fas fa-eye",onClick:()=>{b.setData(e),b.openModal()}},{label:"Editar",icon:"fas fa-edit",onClick:()=>{f.setData(e),f.openModal()}},{label:"Eliminar",icon:"fas fa-trash",onClick:async()=>{window.confirm("\xbfEst\xe1s seguro de que deseas eliminar esta sede?")&&await(async e=>{try{p(!0);const a=await r.C5.getParticipantes();if(a.error)throw new Error("Error al verificar participantes asociados");const s=(a.data||[]).filter(a=>a.id_sede===e||a.sede_id===e||a.sedeId===e);if(s.length>0)return alert("No se puede eliminar la sede porque tiene ".concat(s.length," participante(s) asociado(s). Por favor, reasigna o elimina los participantes primero.")),void p(!1);const i=await r.C5.deleteSede(e);if(i.error)throw new Error(i.error.message||"Error al eliminar sede");await g(),alert("Sede eliminada exitosamente")}catch(a){console.error("Error eliminando sede:",a),alert(a.message||"Error al eliminar sede"),p(!1)}})(e.id)},variant:"danger"}]})})]})]})},e.id))})]}),(0,m.jsx)(n.J$,{isOpen:b.isOpen,onClose:b.closeModal,title:"Detalles de la Sede",data:b.data?[{label:"Nombre",value:b.data.nombre},{label:"Direcci\xf3n",value:b.data.direccion,fullWidth:!0},{label:"Tel\xe9fono",value:b.data.telefono},{label:"Capacidad M\xe1xima",value:b.data.capacidad_maxima?"".concat(b.data.capacidad_maxima," participantes"):"No especificada"},{label:"Estado",value:b.data.estado},{label:"Tipo",value:b.data.tipo||"No especificado"}]:[]}),(0,m.jsx)(n.M9,{isOpen:f.isOpen,onClose:f.closeModal,title:"Editar Sede",onSubmit:async e=>{if(void 0!==e.capacidad_maxima&&null!==e.capacidad_maxima&&""!==e.capacidad_maxima){const a=Number(e.capacidad_maxima);if(isNaN(a)||a<=0)throw new Error("La capacidad m\xe1xima debe ser un n\xfamero positivo")}const a=await r.C5.updateSede(f.data.id,e);if(a.error)throw new Error(a.error.message||"Error al actualizar sede");await g()},initialData:f.data,fields:[{name:"nombre",label:"Nombre",type:"text",required:!0},{name:"telefono",label:"Tel\xe9fono",type:"tel"},{name:"direccion",label:"Direcci\xf3n",type:"textarea",required:!0,fullWidth:!0},{name:"capacidad_maxima",label:"Capacidad M\xe1xima",type:"number",placeholder:"N\xfamero de participantes",min:1},{name:"estado",label:"Estado",type:"select",options:[{value:"Activa",label:"Activa"},{value:"Inactiva",label:"Inactiva"}]},{name:"tipo",label:"Tipo",type:"select",options:[{value:"Principal",label:"Principal"},{value:"Secundaria",label:"Secundaria"},{value:"Temporal",label:"Temporal"}]}]}),(0,m.jsx)(n.s5,{isOpen:h.isOpen,onClose:h.closeModal,title:"Nueva Sede",onSubmit:async e=>{var a,s;if(null===(a=e.nombre)||void 0===a||!a.trim()||null===(s=e.direccion)||void 0===s||!s.trim())throw new Error("Nombre y direcci\xf3n son campos obligatorios");if(void 0!==e.capacidad_maxima&&null!==e.capacidad_maxima&&""!==e.capacidad_maxima){const a=Number(e.capacidad_maxima);if(isNaN(a)||a<=0)throw new Error("La capacidad m\xe1xima debe ser un n\xfamero positivo")}const i=await r.C5.createSede(e);if(i.error)throw new Error(i.error.message||"Error al crear sede");await g()},initialData:{nombre:"",direccion:"",telefono:"",capacidad_maxima:"",estado:"Activa",tipo:"Principal"},fields:[{name:"nombre",label:"Nombre",type:"text",required:!0,placeholder:"Nombre de la sede"},{name:"telefono",label:"Tel\xe9fono",type:"tel",placeholder:"N\xfamero de tel\xe9fono"},{name:"direccion",label:"Direcci\xf3n",type:"textarea",required:!0,placeholder:"Direcci\xf3n completa de la sede",fullWidth:!0},{name:"capacidad_maxima",label:"Capacidad M\xe1xima",type:"number",placeholder:"N\xfamero de participantes",min:1},{name:"estado",label:"Estado",type:"select",options:[{value:"Activa",label:"Activa"},{value:"Inactiva",label:"Inactiva"}]},{name:"tipo",label:"Tipo",type:"select",options:[{value:"Principal",label:"Principal"},{value:"Secundaria",label:"Secundaria"},{value:"Temporal",label:"Temporal"}]}]})]})},x=i.memo(p)}}]);
//# sourceMappingURL=880.201cf591.chunk.js.map