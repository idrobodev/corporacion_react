"use strict";(self.webpackChunkfundacion_todo_por_un_alma=self.webpackChunkfundacion_todo_por_un_alma||[]).push([[341],{1389:(e,a,o)=>{o.d(a,{Bf:()=>d,Cb:()=>p,F:()=>l,NK:()=>n,SP:()=>r,Tq:()=>s,b2:()=>u,eS:()=>t,vc:()=>i,yY:()=>m});const t=e=>e?e.nombres&&e.apellidos?"".concat(e.nombres," ").concat(e.apellidos).trim():e.nombre||"N/A":"N/A",n=e=>e?"object"===typeof e&&null!==e?e.direccion||e.nombre||"N/A":String(e):"N/A",r=e=>{if(!e)return"N/A";const a=String(e).toUpperCase();return"ACTIVO"===a?"Activo":"INACTIVO"===a?"Inactivo":"PAGADA"===a?"Pagada":"PENDIENTE"===a?"Pendiente":"VENCIDA"===a?"Vencida":e},i=e=>e?"MASCULINO"===e?"Masculino":"FEMENINO"===e?"Femenino":e:"N/A",s=(e,a)=>{if(!a)return"N/A";return"".concat(e||"CC",": ").concat(a)},l=(e,a)=>{if(!e||!Array.isArray(e)||0===e.length)return"";return[a.map(e=>'"'.concat(e.label,'"')).join(";"),...e.map(e=>a.map(a=>{const o=c(e,a.key),t=String(o||"");return t.includes(";")||t.includes('"')||t.includes("\n")?'"'.concat(t.replace(/"/g,'""'),'"'):t}).join(";"))].join("\n")},d=(e,a)=>{const o=a.endsWith(".csv")?a:"".concat(a,".csv"),t=e.replace(/\n/g,"\r\n"),n=new Blob(["\ufeff"+t],{type:"text/csv;charset=utf-8;"}),r=document.createElement("a");if(void 0!==r.download){const e=URL.createObjectURL(n);r.setAttribute("href",e),r.setAttribute("download",o),r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(e)}},c=(e,a)=>a.split(".").reduce((e,a)=>null===e||void 0===e?void 0:e[a],e),u=e=>{if(!e)return"";try{return new Date(e).toLocaleDateString("es-ES")}catch(a){return String(e)}},m=e=>{if(null===e||void 0===e)return"";try{return new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0}).format(e)}catch(a){return String(e)}},p=e=>{if(!e)return"";try{const a=new Date(e),o=new Date;let t=o.getFullYear()-a.getFullYear();const n=o.getMonth()-a.getMonth();return(n<0||0===n&&o.getDate()<a.getDate())&&t--,t>0?"".concat(t," a\xf1os"):""}catch(a){return""}}},3341:(e,a,o)=>{o.r(a),o.d(a,{default:()=>b});var t=o(5043),n=o(3474),r=o(4349),i=o(1724),s=o(1379),l=o(3714),d=o(6938),c=o(1389),u=o(579);const m=t.memo(()=>{const[e,a]=(0,t.useState)([]),[o,s]=(0,t.useState)(!0),[d,m]=(0,t.useState)(null),{filters:f,setFilter:b,clearFilters:v}=(0,l.R7)({sede:"Todas",genero:"Todos",estado:"Todos",busqueda:""}),x=(0,l.hS)(),y=(0,l.hS)(),C=(0,l.hS)(),A=(0,t.useCallback)(async()=>{try{var e;s(!0),m(null),console.log("\ud83d\udd04 Cargando participantes...");const o=await r.C5.getParticipantes();if(console.log("\ud83d\udcca Resultado participantes:",o),console.log("\ud83d\udce6 result.data:",o.data),console.log("\ud83d\udce6 result.data type:",typeof o.data),console.log("\ud83d\udce6 result.data isArray:",Array.isArray(o.data)),o.error)throw new Error(o.error.message||"Error al cargar participantes");const t=Array.isArray(null===(e=o.data)||void 0===e?void 0:e.data)?o.data.data:[];console.log("\ud83d\udd04 participantesData:",t),console.log("\ud83d\udd04 participantesData.length:",t.length),a(t),console.log("\u2705 Participantes cargados:",t.length)}catch(o){console.error("\u274c Error cargando participantes:",o),m(o.message||"Error desconocido al cargar participantes"),a([])}finally{s(!1)}},[]);(0,t.useEffect)(()=>{A()},[A]);const N=(0,t.useCallback)((e,a)=>{"ver"===e?x.openModal(null,a):"editar"===e?y.openModal(null,a):"crear"===e&&C.openModal()},[x,y,C]),_=(0,t.useMemo)(()=>{let a=Array.isArray(e)?e:[];if("Todas"!==f.sede&&(a=a.filter(e=>{var a;return((null===(a=e.sede)||void 0===a?void 0:a.direccion)||e.sede||"").toLowerCase().includes(f.sede.toLowerCase())})),"Todos"!==f.genero&&(a=a.filter(e=>e.genero===f.genero)),"Todos"!==f.estado){const e=f.estado.toUpperCase();a=a.filter(a=>a.estado===f.estado||a.estado===e||"Activo"===f.estado&&"ACTIVO"===a.estado||"Inactivo"===f.estado&&"INACTIVO"===a.estado)}if(f.busqueda){const e=f.busqueda.toLowerCase();a=a.filter(a=>(a.numero_documento||"").toLowerCase().includes(e))}return a},[e,f]),w=(0,t.useCallback)(async(e,o)=>{try{await r.C5.updateParticipante(e,{estado:o});const{data:t}=await r.C5.getParticipantes();a(t||[])}catch(t){console.error("Error updating status:",t)}},[]),E=(0,t.useCallback)((e,a)=>{switch(e){case"ver":N("ver",a);break;case"editar":N("editar",a)}},[N]),j=(0,t.useCallback)(()=>{const e=window.open("","_blank"),a=(new Date).toLocaleDateString("es-ES"),o="\n      <!DOCTYPE html>\n      <html>\n        <head>\n          <title>Lista de Participantes - ".concat(a,'</title>\n          <style>\n            body {\n              font-family: Arial, sans-serif;\n              margin: 20px;\n              color: #333;\n            }\n            .header {\n              text-align: center;\n              margin-bottom: 30px;\n              border-bottom: 2px solid #333;\n              padding-bottom: 20px;\n            }\n            .header h1 {\n              color: #2563eb;\n              margin: 0;\n              font-size: 24px;\n            }\n            .filters {\n              margin-bottom: 20px;\n              background: #f8f9fa;\n              padding: 15px;\n              border-radius: 5px;\n            }\n            .filters h3 {\n              margin: 0 0 10px 0;\n              color: #495057;\n            }\n            .filters p {\n              margin: 5px 0;\n              font-size: 14px;\n            }\n            table {\n              width: 100%;\n              border-collapse: collapse;\n              margin-top: 20px;\n            }\n            th, td {\n              border: 1px solid #ddd;\n              padding: 8px 12px;\n              text-align: left;\n            }\n            th {\n              background-color: #f8f9fa;\n              font-weight: bold;\n              color: #495057;\n            }\n            tr:nth-child(even) {\n              background-color: #f9f9f9;\n            }\n            .stats {\n              margin-top: 30px;\n              background: #e3f2fd;\n              padding: 15px;\n              border-radius: 5px;\n            }\n            .stats h3 {\n              margin: 0 0 10px 0;\n              color: #1976d2;\n            }\n            .stats p {\n              margin: 5px 0;\n              font-size: 14px;\n            }\n            @media print {\n              body { margin: 0; }\n              .no-print { display: none; }\n            }\n          </style>\n        </head>\n        <body>\n          <div class="header">\n            <h1>Lista de Participantes</h1>\n            <p>Corporaci\xf3n Todo por un Alma</p>\n            <p>Fecha de generaci\xf3n: ').concat(a,'</p>\n          </div>\n\n          <div class="filters">\n            <h3>Filtros aplicados:</h3>\n            <p><strong>Sede:</strong> ').concat("Todas"===f.sede?"Todas las sedes":f.sede,"</p>\n            <p><strong>G\xe9nero:</strong> ").concat("Todos"===f.genero?"Todos los g\xe9neros":f.genero,"</p>\n            <p><strong>Estado:</strong> ").concat("Todos"===f.estado?"Todos los estados":f.estado,"</p>\n            ").concat(f.busqueda?'<p><strong>B\xfasqueda:</strong> "'.concat(f.busqueda,'"</p>'):"","\n          </div>\n\n          <table>\n            <thead>\n              <tr>\n                <th>Nombre</th>\n                <th>Edad</th>\n                <th>G\xe9nero</th>\n                <th>Tel\xe9fono</th>\n                <th>Sede</th>\n                <th>Estado</th>\n              </tr>\n            </thead>\n            <tbody>\n              ").concat(_.map(e=>"\n                <tr>\n                  <td>".concat((0,c.eS)(e),"</td>\n                  <td>").concat((0,c.Cb)(e.fecha_nacimiento)||"N/A","</td>\n                  <td>").concat((0,c.vc)(e.genero),"</td>\n                  <td>").concat(e.telefono||"N/A","</td>\n                  <td>").concat((0,c.NK)(e.sede),"</td>\n                  <td>").concat((0,c.SP)(e.estado),"</td>\n                </tr>\n              ")).join(""),'\n            </tbody>\n          </table>\n\n          <div class="stats">\n            <h3>Estad\xedsticas:</h3>\n            <p><strong>Total de participantes:</strong> ').concat(_.length,"</p>\n            <p><strong>Activos:</strong> ").concat(_.filter(e=>"ACTIVO"===String(e.estado||"").toUpperCase()).length,"</p>\n            <p><strong>Inactivos:</strong> ").concat(_.filter(e=>"INACTIVO"===String(e.estado||"").toUpperCase()).length,"</p>\n          </div>\n\n          <script>\n            window.onload = function() {\n              window.print();\n              setTimeout(function() {\n                window.close();\n              }, 1000);\n            }\n          <\/script>\n        </body>\n      </html>\n    ");e.document.write(o),e.document.close()},[f,_]),I=(0,t.useCallback)(()=>{const e=_.map(e=>({tipo_documento:e.tipo_documento||"N/A",numero_documento:e.numero_documento||"N/A",nombres:e.nombres||"N/A",apellidos:e.apellidos||"N/A",nombre_completo:(0,c.eS)(e),fecha_nacimiento:(0,c.b2)(e.fecha_nacimiento),edad:(0,c.Cb)(e.fecha_nacimiento)||"N/A",genero:(0,c.vc)(e.genero),telefono:e.telefono||"N/A",sede:(0,c.NK)(e.sede),fecha_ingreso:(0,c.b2)(e.fecha_ingreso),estado:(0,c.SP)(e.estado)})),a=_.filter(e=>"ACTIVO"===String(e.estado||"").toUpperCase()).length,o=_.filter(e=>"INACTIVO"===String(e.estado||"").toUpperCase()).length,t=_.filter(e=>"MASCULINO"===e.genero).length,n=_.filter(e=>"FEMENINO"===e.genero).length,r=(_.length,"".concat(a," (").concat((a/_.length*100).toFixed(1),"%)"),"".concat(o," (").concat((o/_.length*100).toFixed(1),"%)"),"".concat(t," (").concat((t/_.length*100).toFixed(1),"%)"),"".concat(n," (").concat((n/_.length*100).toFixed(1),"%)"),"Todas"!==f.sede&&f.sede,"Todos"!==f.genero&&f.genero,"Todos"!==f.estado&&f.estado,f.busqueda,(0,c.F)(e,[{key:"tipo_documento",label:"Tipo Documento"},{key:"numero_documento",label:"N\xfamero Documento"},{key:"nombres",label:"Nombres"},{key:"apellidos",label:"Apellidos"},{key:"nombre_completo",label:"Nombre Completo"},{key:"fecha_nacimiento",label:"Fecha Nacimiento"},{key:"edad",label:"Edad"},{key:"genero",label:"G\xe9nero"},{key:"telefono",label:"Tel\xe9fono"},{key:"sede",label:"Sede"},{key:"fecha_ingreso",label:"Fecha Ingreso"},{key:"estado",label:"Estado"}])),i="participantes_".concat((new Date).toISOString().split("T")[0],".csv");(0,c.Bf)(r,i)},[_,f]);return o?(0,u.jsx)(n.A,{title:"Participantes",subtitle:"Gesti\xf3n de participantes",loading:!0,loadingText:"Cargando participantes..."}):d?(0,u.jsx)(n.A,{title:"Participantes",subtitle:"Error al cargar datos",loading:!1,children:(0,u.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,u.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:(0,u.jsxs)("p",{className:"text-red-600",children:["Error loading participants: ",d]})})})}):(0,u.jsxs)(n.A,{title:"Gesti\xf3n de Participantes",subtitle:"Administra los participantes de la fundaci\xf3n",extraActions:(0,u.jsxs)("div",{className:"flex space-x-3",children:[(0,u.jsx)(i.EK,{onExportPDF:j,onExportCSV:I}),(0,u.jsxs)("button",{onClick:()=>N("crear",null),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:[(0,u.jsx)("i",{className:"fas fa-plus mr-2"}),"Nuevo Participante"]})]}),children:[(0,u.jsxs)("section",{className:"px-6 py-6",children:[(0,u.jsx)(i.Qn,{filters:[{type:"select",name:"sede",label:"Sede",options:[{value:"Todas",label:"Todas las Sedes"},{value:"Bello Principal",label:"Bello Principal"},{value:"Bello Campestre",label:"Bello Campestre"},{value:"Apartad\xf3",label:"Apartad\xf3"}]},{type:"select",name:"genero",label:"G\xe9nero",options:[{value:"Todos",label:"Todos los G\xe9neros"},{value:"MASCULINO",label:"Masculino"},{value:"FEMENINO",label:"Femenino"}]},{type:"select",name:"estado",label:"Estado",options:[{value:"Todos",label:"Todos los Estados"},{value:"Activo",label:"Activo"},{value:"Inactivo",label:"Inactivo"}]},{type:"search",name:"busqueda",label:"B\xfasqueda por Documento",placeholder:"N\xfamero de documento...",debounceMs:300}],values:f,onChange:b,onClear:v,showClearButton:!0}),(0,u.jsx)("div",{className:"mt-6",children:(0,u.jsx)(i.MD,{stats:[{title:"Total Participantes",value:_.length,icon:"fas fa-users",color:"blue"},{title:"Activos",value:_.filter(e=>"ACTIVO"===e.estado||"Activo"===e.estado).length,icon:"fas fa-user-check",color:"green"},{title:"Inactivos",value:_.filter(e=>"INACTIVO"===e.estado||"Inactivo"===e.estado).length,icon:"fas fa-user-times",color:"red"}],columns:3,gap:"md"})}),(0,u.jsx)("div",{className:"mt-6",children:(0,u.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[(0,u.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,u.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Lista de Participantes"})}),(0,u.jsx)(i.bQ,{data:_,keyExtractor:e=>e.id||e.id_participante,columns:[{key:"participante",header:"Participante",render:e=>{const a=e.nombres&&e.apellidos?"".concat(e.nombres," ").concat(e.apellidos):e.nombre||"N/A",o=e.tipo_documento||"N/A",t=e.numero_documento||"N/A";return(0,u.jsxs)("div",{className:"flex items-center",children:[(0,u.jsx)("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:(0,u.jsx)("i",{className:"fas fa-user text-blue-600"})}),(0,u.jsxs)("div",{className:"ml-4",children:[(0,u.jsx)("div",{className:"text-sm font-medium text-gray-900",children:a}),(0,u.jsxs)("div",{className:"text-sm text-gray-500",children:[o," ",t]})]})]})}},{key:"edad",header:"Edad",render:e=>{if(e.fecha_nacimiento){const a=new Date(e.fecha_nacimiento),o=new Date;let t=o.getFullYear()-a.getFullYear();const n=o.getMonth()-a.getMonth();return(n<0||0===n&&o.getDate()<a.getDate())&&t--,"".concat(t," a\xf1os")}return e.edad?"".concat(e.edad," a\xf1os"):"N/A"}},{key:"genero",header:"G\xe9nero",render:e=>"MASCULINO"===e.genero?"Masculino":"FEMENINO"===e.genero?"Femenino":"N/A"},{key:"fecha_ingreso",header:"Fecha Ingreso",render:e=>e.fecha_ingreso?new Date(e.fecha_ingreso).toLocaleDateString("es-ES"):"N/A"},{key:"sede",header:"Sede",render:e=>{var a;return(null===(a=e.sede)||void 0===a?void 0:a.direccion)||e.sede||"N/A"}},{key:"estado",header:"Estado",render:e=>(0,u.jsx)(i.re,{currentStatus:e.estado,statuses:[{value:"ACTIVO",label:"Activo",variant:"success"},{value:"Activo",label:"Activo",variant:"success"},{value:"INACTIVO",label:"Inactivo",variant:"danger"},{value:"Inactivo",label:"Inactivo",variant:"danger"}],onChange:a=>w(e.id||e.id_participante,a)})},{key:"acciones",header:"Acciones",render:e=>(0,u.jsx)(i.yd,{actions:[{label:"Ver detalles",icon:"fas fa-eye",onClick:()=>E("ver",e)},{label:"Editar",icon:"fas fa-edit",onClick:()=>E("editar",e)}]})}],loading:o})]})})]}),(0,u.jsx)(p,{isOpen:x.isOpen,onClose:x.closeModal,participante:x.modalData,onCrearAcudiente:()=>{console.log("Crear acudiente para participante:",x.modalData)}}),(0,u.jsx)(g,{isOpen:y.isOpen,onClose:y.closeModal,participante:y.modalData,onActualizar:A}),(0,u.jsx)(h,{isOpen:C.isOpen,onClose:C.closeModal,onCrear:A})]})}),p=e=>{var a;let{isOpen:o,onClose:n,participante:i,onCrearAcudiente:l}=e;const[d,c]=(0,t.useState)([]),[m,p]=(0,t.useState)(!1),g=(0,t.useCallback)(async()=>{if(null!==i&&void 0!==i&&i.id||null!==i&&void 0!==i&&i.id_participante)try{p(!0);const e=i.id||i.id_participante,a=await r.C5.getAcudientesByParticipante(e);a.data&&Array.isArray(a.data)?c(a.data):c([])}catch(e){console.error("Error loading acudientes:",e),c([])}finally{p(!1)}},[i]);if((0,t.useEffect)(()=>{o&&i&&g()},[o,i,g]),!i)return null;const h=i.nombres&&i.apellidos?"".concat(i.nombres," ").concat(i.apellidos):i.nombre||"N/A",f=(()=>{if(i.fecha_nacimiento){const e=new Date(i.fecha_nacimiento),a=new Date;let o=a.getFullYear()-e.getFullYear();const t=a.getMonth()-e.getMonth();return(t<0||0===t&&a.getDate()<e.getDate())&&o--,o}return i.edad||"N/A"})(),b="ACTIVO"===i.estado||"Activo"===i.estado?"Activo":"Inactivo",v="ACTIVO"===i.estado||"Activo"===i.estado?"bg-green-100 text-green-800":"bg-red-100 text-red-800";return(0,u.jsx)(s.J$,{isOpen:o,onClose:n,title:"Detalles del Participante",data:[{label:"Nombre Completo",value:h},{label:"Tipo de Documento",value:i.tipo_documento||"N/A"},{label:"N\xfamero de Documento",value:i.numero_documento||"N/A"},{label:"Edad",value:"number"===typeof f?"".concat(f," a\xf1os"):f},{label:"Fecha de Nacimiento",value:i.fecha_nacimiento?new Date(i.fecha_nacimiento).toLocaleDateString("es-ES"):"N/A"},{label:"G\xe9nero",value:"MASCULINO"===i.genero?"Masculino":"FEMENINO"===i.genero?"Femenino":"N/A"},{label:"Fecha de Ingreso",value:i.fecha_ingreso?new Date(i.fecha_ingreso).toLocaleDateString("es-ES"):"N/A"},{label:"Sede",value:(null===(a=i.sede)||void 0===a?void 0:a.direccion)||i.sede||"N/A"},{label:"Tel\xe9fono",value:i.telefono||"N/A"},{label:"Estado",value:(0,u.jsx)("span",{className:"inline-flex px-3 py-1 text-sm font-semibold rounded-full ".concat(v),children:b})},{label:"Acudientes",value:(0,u.jsx)("div",{className:"mt-2",children:m?(0,u.jsx)("p",{className:"text-sm text-gray-500",children:"Cargando acudientes..."}):d.length>0?(0,u.jsxs)("div",{className:"space-y-2",children:[d.map((e,a)=>(0,u.jsx)("div",{className:"bg-gray-50 p-3 rounded-lg border border-gray-200",children:(0,u.jsx)("div",{className:"flex items-start justify-between",children:(0,u.jsxs)("div",{children:[(0,u.jsxs)("p",{className:"text-sm font-medium text-gray-900",children:[e.nombres," ",e.apellidos]}),(0,u.jsxs)("p",{className:"text-xs text-gray-500",children:[e.parentesco," \u2022 ",e.tipo_documento," ",e.numero_documento]}),(0,u.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[(0,u.jsx)("i",{className:"fas fa-phone mr-1"}),e.telefono,e.email&&(0,u.jsxs)("span",{className:"ml-2",children:[(0,u.jsx)("i",{className:"fas fa-envelope mr-1"}),e.email]})]})]})})},e.id_acudiente||a)),(0,u.jsxs)("button",{onClick:l,className:"mt-2 text-sm text-blue-600 hover:text-blue-700 font-medium",children:[(0,u.jsx)("i",{className:"fas fa-plus mr-1"}),"Agregar otro acudiente"]})]}):(0,u.jsxs)("div",{className:"text-center py-4",children:[(0,u.jsx)("p",{className:"text-sm text-gray-500 mb-2",children:"No hay acudientes registrados"}),(0,u.jsxs)("button",{onClick:l,className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:[(0,u.jsx)("i",{className:"fas fa-plus mr-1"}),"Agregar acudiente"]})]})})}]})},g=e=>{var a,o;let{isOpen:t,onClose:n,participante:i,onActualizar:l}=e;if(!i)return null;return(0,u.jsx)(s.M9,{isOpen:t,onClose:n,title:"Editar Participante",initialData:{tipo_documento:i.tipo_documento||"CC",numero_documento:i.numero_documento||"",nombres:i.nombres||(null===(a=i.nombre)||void 0===a?void 0:a.split(" ")[0])||"",apellidos:i.apellidos||(null===(o=i.nombre)||void 0===o?void 0:o.split(" ").slice(1).join(" "))||"",fecha_nacimiento:i.fecha_nacimiento||"",genero:i.genero||"MASCULINO",fecha_ingreso:i.fecha_ingreso||"",estado:i.estado||"ACTIVO",id_sede:i.id_sede||i.sede_id||""},onSubmit:async e=>{var a,o;if(console.log("\ud83d\udd04 Actualizando participante:",e),!e.tipo_documento||!e.numero_documento)throw new Error("Tipo y n\xfamero de documento son requeridos");if(null===(a=e.nombres)||void 0===a||!a.trim()||null===(o=e.apellidos)||void 0===o||!o.trim())throw new Error("Nombres y apellidos son requeridos");if(!e.fecha_nacimiento||!e.fecha_ingreso)throw new Error("Fechas de nacimiento e ingreso son requeridas");if(!e.id_sede)throw new Error("Debe seleccionar una sede");const t=(0,d.Zi)(e.fecha_nacimiento);if(!t.isValid)throw new Error(t.error);const n=(0,d.Hc)(e.fecha_ingreso);if(!n.isValid)throw new Error(n.error);const s=i.id||i.id_participante,c=await(0,d.Ri)(e.numero_documento,s);if(!c.isValid)throw new Error(c.error);const u=await(0,d.Wk)(e.id_sede);if(!u.isValid)throw new Error(u.error);const m=await r.C5.updateParticipante(s,e);if(m.error)throw new Error(m.error.message||"Error al actualizar participante");console.log("\u2705 Participante actualizado exitosamente"),l()},submitLabel:"Guardar Cambios",children:e=>{let{formData:a,handleChange:o,errors:t}=e;return(0,u.jsx)(f,{formData:a,handleChange:o,errors:t})}})},h=e=>{let{isOpen:a,onClose:o,onCrear:t}=e;return(0,u.jsx)(s.s5,{isOpen:a,onClose:o,title:"Nuevo Participante",defaultValues:{tipo_documento:"CC",numero_documento:"",nombres:"",apellidos:"",fecha_nacimiento:"",genero:"MASCULINO",fecha_ingreso:"",estado:"ACTIVO",id_sede:""},onSubmit:async e=>{var a,o;if(console.log("\ud83d\udd04 Creando participante:",e),!e.tipo_documento||!e.numero_documento)throw new Error("Tipo y n\xfamero de documento son requeridos");if(null===(a=e.nombres)||void 0===a||!a.trim()||null===(o=e.apellidos)||void 0===o||!o.trim())throw new Error("Nombres y apellidos son requeridos");if(!e.fecha_nacimiento||!e.fecha_ingreso)throw new Error("Fechas de nacimiento e ingreso son requeridas");if(!e.id_sede)throw new Error("Debe seleccionar una sede");const n=(0,d.Zi)(e.fecha_nacimiento);if(!n.isValid)throw new Error(n.error);const i=(0,d.Hc)(e.fecha_ingreso);if(!i.isValid)throw new Error(i.error);const s=await(0,d.Ri)(e.numero_documento);if(!s.isValid)throw new Error(s.error);const l=await(0,d.Wk)(e.id_sede);if(!l.isValid)throw new Error(l.error);const c=await r.C5.createParticipante(e);if(c.error)throw new Error(c.error.message||"Error al crear participante");console.log("\u2705 Participante creado exitosamente"),t()},submitLabel:"Crear Participante",children:e=>{let{formData:a,handleChange:o,errors:t}=e;return(0,u.jsx)(f,{formData:a,handleChange:o,errors:t})}})},f=e=>{let{formData:a,handleChange:o,errors:n}=e;const[s,l]=(0,t.useState)([]),[d,c]=(0,t.useState)(!0);return(0,t.useEffect)(()=>{(async()=>{try{c(!0);const e=await r.C5.getSedes();e.data&&Array.isArray(e.data)&&l(e.data)}catch(e){console.error("Error loading sedes:",e)}finally{c(!1)}})()},[]),(0,u.jsxs)(i.gE,{columns:2,gap:"md",children:[(0,u.jsx)(i.FX,{label:"Tipo de Documento",name:"tipo_documento",value:a.tipo_documento,onChange:e=>o("tipo_documento",e),options:[{value:"CC",label:"C\xe9dula de Ciudadan\xeda"},{value:"TI",label:"Tarjeta de Identidad"},{value:"CE",label:"C\xe9dula de Extranjer\xeda"},{value:"PASAPORTE",label:"Pasaporte"}],error:null===n||void 0===n?void 0:n.tipo_documento,required:!0}),(0,u.jsx)(i.ZQ,{label:"N\xfamero de Documento",name:"numero_documento",type:"text",value:a.numero_documento,onChange:e=>o("numero_documento",e),error:null===n||void 0===n?void 0:n.numero_documento,required:!0,placeholder:"Ingrese el n\xfamero de documento"}),(0,u.jsx)(i.ZQ,{label:"Nombres",name:"nombres",type:"text",value:a.nombres,onChange:e=>o("nombres",e),error:null===n||void 0===n?void 0:n.nombres,required:!0,placeholder:"Ingrese los nombres"}),(0,u.jsx)(i.ZQ,{label:"Apellidos",name:"apellidos",type:"text",value:a.apellidos,onChange:e=>o("apellidos",e),error:null===n||void 0===n?void 0:n.apellidos,required:!0,placeholder:"Ingrese los apellidos"}),(0,u.jsx)(i.ZQ,{label:"Fecha de Nacimiento",name:"fecha_nacimiento",type:"date",value:a.fecha_nacimiento,onChange:e=>o("fecha_nacimiento",e),error:null===n||void 0===n?void 0:n.fecha_nacimiento,required:!0}),(0,u.jsx)(i.FX,{label:"G\xe9nero",name:"genero",value:a.genero,onChange:e=>o("genero",e),options:[{value:"MASCULINO",label:"Masculino"},{value:"FEMENINO",label:"Femenino"}],error:null===n||void 0===n?void 0:n.genero,required:!0}),(0,u.jsx)(i.ZQ,{label:"Fecha de Ingreso",name:"fecha_ingreso",type:"date",value:a.fecha_ingreso,onChange:e=>o("fecha_ingreso",e),error:null===n||void 0===n?void 0:n.fecha_ingreso,required:!0}),(0,u.jsx)(i.FX,{label:"Estado",name:"estado",value:a.estado,onChange:e=>o("estado",e),options:[{value:"ACTIVO",label:"Activo"},{value:"INACTIVO",label:"Inactivo"}],error:null===n||void 0===n?void 0:n.estado,required:!0}),(0,u.jsx)(i.FX,{label:"Sede",name:"id_sede",value:a.id_sede,onChange:e=>o("id_sede",e),options:d?[{value:"",label:"Cargando sedes..."}]:s.map(e=>({value:e.id_sede||e.id,label:e.direccion||e.nombre})),error:null===n||void 0===n?void 0:n.id_sede,required:!0,disabled:d})]})},b=m},6938:(e,a,o)=>{o.d(a,{BZ:()=>r,DT:()=>i,F2:()=>m,Hc:()=>d,Ri:()=>n,Wk:()=>u,Zi:()=>l,ju:()=>c});var t=o(4349);const n=async function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{if(!e||!e.trim())return{isValid:!1,error:"El n\xfamero de documento es requerido"};const o=await t.C5.getParticipantes();if(o.data&&Array.isArray(o.data)){if(o.data.some(o=>{const t=o.id||o.id_participante;return o.numero_documento===e&&t!==a}))return{isValid:!1,error:"El n\xfamero de documento ya est\xe1 registrado para otro participante"}}return{isValid:!0,error:null}}catch(o){return console.error("Error validating participante documento:",o),{isValid:!0,error:null}}},r=async function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{if(!e||!e.trim())return{isValid:!1,error:"El n\xfamero de documento es requerido"};const o=await t.C5.getAcudientes();if(o.data&&Array.isArray(o.data)){if(o.data.some(o=>{const t=o.id||o.id_acudiente;return o.numero_documento===e&&t!==a}))return{isValid:!1,error:"El n\xfamero de documento ya est\xe1 registrado para otro acudiente"}}return{isValid:!0,error:null}}catch(o){return console.error("Error validating acudiente documento:",o),{isValid:!0,error:null}}},i=e=>{if(!e||!e.trim())return{isValid:!1,error:"El email es requerido"};return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)?{isValid:!0,error:null}:{isValid:!1,error:"El formato del email no es v\xe1lido"}},s=function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"fecha";if(!e)return{isValid:!1,error:"La ".concat(a," es requerida")};const o=new Date(e),t=new Date;return t.setHours(23,59,59,999),o instanceof Date&&!isNaN(o.getTime())?o>t?{isValid:!1,error:"La ".concat(a," no puede ser futura")}:{isValid:!0,error:null}:{isValid:!1,error:"La ".concat(a," no es v\xe1lida")}},l=e=>s(e,"fecha de nacimiento"),d=e=>s(e,"fecha de ingreso"),c=async e=>{try{if(!e)return{isValid:!1,error:"Debe seleccionar un participante"};const a=await t.C5.getParticipantes();if(a.data&&Array.isArray(a.data)){if(!a.data.some(a=>(a.id_participante||a.id)===parseInt(e)))return{isValid:!1,error:"El participante seleccionado no existe"}}return{isValid:!0,error:null}}catch(a){return console.error("Error validating participante exists:",a),{isValid:!1,error:"Error al validar el participante"}}},u=async e=>{try{if(!e)return{isValid:!1,error:"Debe seleccionar una sede"};const a=await t.C5.getSedes();if(a.data&&Array.isArray(a.data)){if(!a.data.some(a=>(a.id_sede||a.id)===parseInt(e)))return{isValid:!1,error:"La sede seleccionada no existe"}}return{isValid:!0,error:null}}catch(a){return console.error("Error validating sede exists:",a),{isValid:!1,error:"Error al validar la sede"}}},m=async(e,a)=>{const o=await c(e);if(!o.isValid)return o;const n=await(async e=>{try{if(!e)return{isValid:!1,error:"Debe seleccionar un acudiente"};const a=await t.C5.getAcudientes();return a.data&&Array.isArray(a.data)&&!a.data.some(a=>(a.id_acudiente||a.id)===parseInt(e))?{isValid:!1,error:"El acudiente seleccionado no existe"}:{isValid:!0,error:null}}catch(a){return console.error("Error validating acudiente exists:",a),{isValid:!1,error:"Error al validar el acudiente"}}})(a);return n.isValid?{isValid:!0,error:null}:n}}}]);
//# sourceMappingURL=341.2bdb2372.chunk.js.map