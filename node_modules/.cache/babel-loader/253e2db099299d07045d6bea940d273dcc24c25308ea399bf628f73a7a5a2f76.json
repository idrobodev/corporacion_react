{"ast":null,"code":"import React,{useState,useEffect,useMemo,useCallback}from\"react\";import DashboardLayout from\"components/layout/DashboardLayout\";import{dbService,ROLES}from\"shared/services\";import{FilterBar}from\"components/UI/Filter\";import{StatsGrid}from\"components/UI/Card\";import{DataTable}from\"components/UI/Table\";import{ViewDetailsModal,EditFormModal,CreateFormModal}from\"components/common/CRUDModals\";import{useFilters,useModal}from\"shared/hooks\";import{validateEmail}from\"shared/utils/validationUtils\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const UsuariosComponent=()=>{const[usuarios,setUsuarios]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const[canEdit,setCanEdit]=useState(false);// Use custom hooks\nconst{filters:filtros,setFilter,clearFilters}=useFilters({rol:\"Todos\",busqueda:\"\"});const verModal=useModal();const editarModal=useModal();const crearModal=useModal();// Función para cargar usuarios\nconst loadUsuarios=useCallback(async()=>{try{var _result$data;setLoading(true);setError(null);console.log('🔄 Cargando usuarios...');const result=await dbService.getUsuarios();console.log('📊 Resultado usuarios:',result);if(result.error){throw new Error(result.error.message||'Error al cargar usuarios');}// La respuesta puede ser {data: [...], error: null} o {data: {data: [...]}, error: null}\nlet usuariosData=[];if(Array.isArray(result.data)){usuariosData=result.data;}else if(Array.isArray((_result$data=result.data)===null||_result$data===void 0?void 0:_result$data.data)){usuariosData=result.data.data;}else{usuariosData=[];}setUsuarios(usuariosData);console.log('✅ Usuarios cargados:',usuariosData.length);}catch(err){console.error('❌ Error cargando usuarios:',err);setError(err.message||'Error desconocido al cargar usuarios');setUsuarios([]);}finally{setLoading(false);}},[]);// Exponer funciones globalmente para el menú desplegable\nuseEffect(()=>{window.verModal=verModal;window.editarModal=editarModal;window.deleteUser=async userId=>{try{const result=await dbService.deleteUsuario(userId);if(result.error){alert('Error al eliminar usuario: '+result.error.message);}else{alert('Usuario eliminado exitosamente');await loadUsuarios();}}catch(error){alert('Error al eliminar usuario: '+error.message);}};return()=>{delete window.verModal;delete window.editarModal;delete window.deleteUser;};},[verModal,editarModal,loadUsuarios]);// Cargar usuario actual y verificar permisos\nuseEffect(()=>{const loadCurrentUser=async()=>{try{console.log('🔐 Verificando permisos de administrador...');// Verificar si tiene permisos de administrador\nconst hasPermission=await dbService.hasPermission(ROLES.ADMINISTRADOR);console.log('✅ Permisos de administrador obtenidos:',hasPermission);setCanEdit(hasPermission);console.log('🎯 canEdit establecido como:',hasPermission);}catch(err){console.error('❌ Error cargando permisos:',err);setCanEdit(false);}};loadCurrentUser();loadUsuarios();},[loadUsuarios]);// Filtrar usuarios\nconst filteredUsuarios=useMemo(()=>{const safeUsuarios=Array.isArray(usuarios)?usuarios:[];let filtered=safeUsuarios;if(filtros.rol!==\"Todos\"){filtered=filtered.filter(u=>(u.rol||u.role)===filtros.rol);}if(filtros.busqueda){filtered=filtered.filter(u=>(u.email||'').toLowerCase().includes(filtros.busqueda.toLowerCase()));}return filtered;},[usuarios,filtros]);// Estadísticas\nconst statsData=useMemo(()=>[{title:\"Total Usuarios\",value:filteredUsuarios.length,icon:\"fas fa-users\",color:\"blue\"}],[filteredUsuarios]);if(loading){return/*#__PURE__*/_jsx(DashboardLayout,{title:\"Usuarios\",subtitle:\"Gesti\\xF3n de usuarios\",loading:true,loadingText:\"Cargando usuarios...\"});}if(error){return/*#__PURE__*/_jsx(DashboardLayout,{title:\"Usuarios\",subtitle:\"Error al cargar datos\",loading:false,children:/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center h-screen\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-red-50 border border-red-200 rounded-lg p-4\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"text-red-600\",children:[\"Error loading usuarios del sistema: \",error]})})})});}// Verificar permisos de acceso a la página\nif(!canEdit){return/*#__PURE__*/_jsx(DashboardLayout,{title:\"Usuarios\",subtitle:\"Acceso denegado\",children:/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center h-screen\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-yellow-50 border border-yellow-200 rounded-lg p-8 text-center max-w-md\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-lock text-yellow-600 text-5xl mb-4\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-semibold text-gray-900 mb-2\",children:\"Acceso Denegado\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"No tienes permisos para acceder a esta p\\xE1gina. Solo los administradores pueden gestionar usuarios.\"})]})})});}const filterConfig=[{type:'select',name:'rol',label:'Rol',options:[{value:'Todos',label:'Todos los Roles'},{value:ROLES.ADMINISTRADOR,label:'Administrador'},{value:ROLES.CONSULTA,label:'Consulta'}]},{type:'search',name:'busqueda',label:'Búsqueda',placeholder:'Buscar por email...'}];return/*#__PURE__*/_jsxs(DashboardLayout,{title:\"Gesti\\xF3n de Usuarios del sistema\",subtitle:\"Administra los usuarios del sistema\",extraActions:canEdit&&/*#__PURE__*/_jsxs(\"button\",{onClick:()=>crearModal.openModal(),className:\"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-plus mr-2\"}),\"Nuevo Usuario\"]}),children:[/*#__PURE__*/_jsxs(\"section\",{className:\"px-6 py-6\",children:[/*#__PURE__*/_jsx(FilterBar,{filters:filterConfig,values:filtros,onChange:setFilter,onClear:clearFilters,showClearButton:true}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-6\",children:/*#__PURE__*/_jsx(StatsGrid,{stats:statsData,columns:3,gap:\"md\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-sm border border-gray-200\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-6 border-b border-gray-200\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-800\",children:\"Lista de Usuarios del sistema\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 mt-1\",children:\"Gestiona los usuarios del sistema\"})]}),canEdit?/*#__PURE__*/_jsxs(\"span\",{className:\"inline-flex items-center px-3 py-1.5 rounded-full text-sm font-medium bg-green-100 text-green-800\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-user-shield mr-2\"}),\"Modo Administrador\"]}):/*#__PURE__*/_jsxs(\"span\",{className:\"inline-flex items-center px-3 py-1.5 rounded-full text-sm font-medium bg-yellow-100 text-yellow-800\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-eye mr-2\"}),\"Modo Solo Lectura\"]})]})}),filteredUsuarios.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"p-12 text-center\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-users text-gray-300 text-4xl mb-4\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-medium text-gray-900 mb-2\",children:\"No se encontraron usuarios del sistema\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500\",children:\"No hay usuarios que coincidan con los filtros aplicados.\"})]}):/*#__PURE__*/_jsx(DataTable,{columns:[{key:'email',header:'Email',render:usuario=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center mr-3\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-user text-blue-600\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-medium text-gray-900\",children:usuario.email}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-500\",children:[\"ID: \",usuario.id_usuario||usuario.id]})]})]})},{key:'rol',header:'Rol',render:usuario=>{const userRole=usuario.rol||usuario.role;return/*#__PURE__*/_jsxs(\"span\",{className:\"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium \".concat(userRole===ROLES.ADMINISTRADOR||userRole==='ADMINISTRADOR'?'bg-purple-100 text-purple-800':'bg-green-100 text-green-800'),children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas \".concat(userRole===ROLES.ADMINISTRADOR||userRole==='ADMINISTRADOR'?'fa-user-shield':'fa-user',\" mr-2\")}),userRole===ROLES.ADMINISTRADOR||userRole==='ADMINISTRADOR'?'Administrador':'Consulta']});}},{key:'acciones',header:'Acciones',render:usuario=>{console.log('🔍 Renderizando acciones para usuario:',usuario.email,'canEdit:',canEdit);if(canEdit){console.log('🎯 Renderizando ActionDropdown para:',usuario.email);const userRole=usuario.rol||usuario.role;const isAdmin=userRole===ROLES.ADMINISTRADOR||userRole==='ADMINISTRADOR';return/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[!isAdmin&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>{console.log('✏️ Editar usuario:',usuario.email);editarModal.openModal('edit',usuario);},className:\"text-blue-600 hover:text-blue-800 p-2 rounded-lg hover:bg-blue-50 transition-colors\",title:\"Editar usuario\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-edit\"})}),!isAdmin&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>{console.log('🗑️ Eliminar usuario:',usuario.email);if(window.confirm('¿Estás seguro de que quieres eliminar este usuario?')){window.deleteUser&&window.deleteUser(usuario.id_usuario||usuario.id);}},className:\"text-red-600 hover:text-red-800 p-2 rounded-lg hover:bg-red-50 transition-colors\",title:\"Eliminar usuario\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-trash\"})}),isAdmin&&/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs text-gray-500 font-medium px-2 py-1 bg-gray-100 rounded\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-shield-alt mr-1\"}),\"Protegido\"]})]});}else{return/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{console.log('👁️ Abriendo modal de solo lectura para:',usuario.email);verModal.openModal('view',usuario);},className:\"text-blue-600 hover:text-blue-800 text-sm font-medium\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-eye mr-1\"}),\"Ver Detalles\"]}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs text-yellow-600 font-medium\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-lock mr-1\"}),\"Solo Lectura\"]})]});}}}],data:filteredUsuarios,keyExtractor:usuario=>usuario.id_usuario||usuario.id,loading:loading})]})})]}),/*#__PURE__*/_jsx(ViewDetailsModal,{isOpen:verModal.isOpen,onClose:verModal.closeModal,title:\"Detalles del Usuario del sistema\",data:verModal.modalData?[{label:'ID',value:verModal.modalData.id_usuario||verModal.modalData.id},{label:'Email',value:verModal.modalData.email},{label:'Contraseña',value:'••••••••',helperText:'La contraseña está oculta por seguridad'},{label:'Rol',value:(()=>{const rol=verModal.modalData.rol||verModal.modalData.role;// Comparación más robusta\nif(rol===ROLES.ADMINISTRADOR||rol==='ADMINISTRADOR'){return'Administrador';}return'Consulta';})()},{label:'Fecha de creación',value:new Date(verModal.modalData.created_at).toLocaleString('es-ES')},{label:'Última actualización',value:new Date(verModal.modalData.updated_at).toLocaleString('es-ES')}]:[]}),/*#__PURE__*/_jsx(EditFormModal,{isOpen:editarModal.isOpen,onClose:editarModal.closeModal,title:\"Editar Usuario del sistema\",onSubmit:async formData=>{// Validar email\nconst emailValidation=validateEmail(formData.email);if(!emailValidation.isValid){throw new Error(emailValidation.error);}// Validar rol\nif(!formData.rol||formData.rol!==ROLES.ADMINISTRADOR&&formData.rol!==ROLES.CONSULTA&&formData.rol!=='ADMINISTRADOR'&&formData.rol!=='CONSULTA'){throw new Error('Rol inválido');}// Si no se proporciona password, no lo incluimos en la actualización\nconst updateData={email:formData.email,role:formData.rol// El backend espera 'role', no 'rol'\n};if(formData.password&&formData.password.trim()){if(formData.password.length<8){throw new Error('La contraseña debe tener al menos 8 caracteres');}updateData.password=formData.password;}const result=await dbService.updateUsuario(editarModal.modalData.id_usuario||editarModal.modalData.id,updateData);if(result.error){throw new Error(result.error.message||'Error al actualizar usuario');}await loadUsuarios();},initialData:editarModal.modalData?{email:editarModal.modalData.email,password:'',rol:editarModal.modalData.rol||editarModal.modalData.role}:{email:'',password:'',rol:ROLES.CONSULTA},fields:[{name:'email',label:'Email',type:'email',required:true,placeholder:'usuario@ejemplo.com'},{name:'currentPassword',label:'Contraseña Actual (solo lectura)',type:'password',readOnly:true,placeholder:'Contraseña actual del usuario',value:'••••••••',// Mostrar puntos por seguridad\nhelperText:'La contraseña actual no se puede ver por seguridad'},{name:'password',label:'Nueva Contraseña (opcional)',type:'password',placeholder:'Dejar en blanco para mantener la actual',helperText:'Mínimo 8 caracteres. Si se deja en blanco, mantiene la contraseña actual.'},{name:'rol',label:'Rol',type:'select',required:true,options:[{value:ROLES.CONSULTA,label:'Consulta'}]}]}),/*#__PURE__*/_jsx(CreateFormModal,{isOpen:crearModal.isOpen,onClose:crearModal.closeModal,title:\"Nuevo Usuario del sistema\",onSubmit:async formData=>{// Validar email\nconst emailValidation=validateEmail(formData.email);if(!emailValidation.isValid){throw new Error(emailValidation.error);}// Validar password\nif(!formData.password||formData.password.length<8){throw new Error('La contraseña debe tener al menos 8 caracteres');}// Validar rol\nif(!formData.rol||formData.rol!==ROLES.ADMINISTRADOR&&formData.rol!==ROLES.CONSULTA&&formData.rol!=='ADMINISTRADOR'&&formData.rol!=='CONSULTA'){throw new Error('Rol inválido');}// Convertir 'rol' a 'role' para el backend\nconst userData={email:formData.email,password:formData.password,role:formData.rol};const result=await dbService.createUsuario(userData);if(result.error){throw new Error(result.error.message||'Error al crear usuario');}await loadUsuarios();},initialData:{email:'',password:'',rol:ROLES.CONSULTA},fields:[{name:'email',label:'Email',type:'email',required:true,placeholder:'usuario@ejemplo.com'},{name:'password',label:'Contraseña',type:'password',required:true,placeholder:'Mínimo 8 caracteres',helperText:'Mínimo 8 caracteres. La contraseña debe ser segura.'},{name:'rol',label:'Rol',type:'select',required:true,options:[{value:ROLES.ADMINISTRADOR,label:'Administrador'},{value:ROLES.CONSULTA,label:'Consulta'}]}]})]});};// Wrap with React.memo to prevent unnecessary re-renders\nconst Usuarios=/*#__PURE__*/React.memo(UsuariosComponent);export default Usuarios;","map":{"version":3,"names":["React","useState","useEffect","useMemo","useCallback","DashboardLayout","dbService","ROLES","FilterBar","StatsGrid","DataTable","ViewDetailsModal","EditFormModal","CreateFormModal","useFilters","useModal","validateEmail","jsx","_jsx","jsxs","_jsxs","UsuariosComponent","usuarios","setUsuarios","loading","setLoading","error","setError","canEdit","setCanEdit","filters","filtros","setFilter","clearFilters","rol","busqueda","verModal","editarModal","crearModal","loadUsuarios","_result$data","console","log","result","getUsuarios","Error","message","usuariosData","Array","isArray","data","length","err","window","deleteUser","userId","deleteUsuario","alert","loadCurrentUser","hasPermission","ADMINISTRADOR","filteredUsuarios","safeUsuarios","filtered","filter","u","role","email","toLowerCase","includes","statsData","title","value","icon","color","subtitle","loadingText","children","className","filterConfig","type","name","label","options","CONSULTA","placeholder","extraActions","onClick","openModal","values","onChange","onClear","showClearButton","stats","columns","gap","key","header","render","usuario","id_usuario","id","userRole","concat","isAdmin","confirm","keyExtractor","isOpen","onClose","closeModal","modalData","helperText","Date","created_at","toLocaleString","updated_at","onSubmit","formData","emailValidation","isValid","updateData","password","trim","updateUsuario","initialData","fields","required","readOnly","userData","createUsuario","Usuarios","memo"],"sources":["/Users/todoporunalma/Desktop/Corporacion/coptua_react/src/pages/Dashboard/Usuarios.jsx"],"sourcesContent":["import React, { useState, useEffect, useMemo, useCallback } from \"react\";\nimport DashboardLayout from \"components/layout/DashboardLayout\";\nimport { dbService, ROLES } from \"shared/services\";\nimport { FilterBar } from \"components/UI/Filter\";\nimport { StatsGrid } from \"components/UI/Card\";\nimport { DataTable } from \"components/UI/Table\";\nimport { ViewDetailsModal, EditFormModal, CreateFormModal } from \"components/common/CRUDModals\";\nimport { useFilters, useModal } from \"shared/hooks\";\nimport { validateEmail } from \"shared/utils/validationUtils\";\n\nconst UsuariosComponent = () => {\n  const [usuarios, setUsuarios] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [canEdit, setCanEdit] = useState(false);\n\n  // Use custom hooks\n  const { filters: filtros, setFilter, clearFilters } = useFilters({\n    rol: \"Todos\",\n    busqueda: \"\"\n  });\n\n  const verModal = useModal();\n  const editarModal = useModal();\n  const crearModal = useModal();\n\n  // Función para cargar usuarios\n  const loadUsuarios = useCallback(async () => {\n    try {\n      setLoading(true);\n      setError(null);\n      console.log('🔄 Cargando usuarios...');\n\n      const result = await dbService.getUsuarios();\n      console.log('📊 Resultado usuarios:', result);\n\n      if (result.error) {\n        throw new Error(result.error.message || 'Error al cargar usuarios');\n      }\n\n      // La respuesta puede ser {data: [...], error: null} o {data: {data: [...]}, error: null}\n      let usuariosData = [];\n      if (Array.isArray(result.data)) {\n        usuariosData = result.data;\n      } else if (Array.isArray(result.data?.data)) {\n        usuariosData = result.data.data;\n      } else {\n        usuariosData = [];\n      }\n\n      setUsuarios(usuariosData);\n      console.log('✅ Usuarios cargados:', usuariosData.length);\n    } catch (err) {\n      console.error('❌ Error cargando usuarios:', err);\n      setError(err.message || 'Error desconocido al cargar usuarios');\n      setUsuarios([]);\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n\n  // Exponer funciones globalmente para el menú desplegable\n  useEffect(() => {\n    window.verModal = verModal;\n    window.editarModal = editarModal;\n    window.deleteUser = async (userId) => {\n      try {\n        const result = await dbService.deleteUsuario(userId);\n        if (result.error) {\n          alert('Error al eliminar usuario: ' + result.error.message);\n        } else {\n          alert('Usuario eliminado exitosamente');\n          await loadUsuarios();\n        }\n      } catch (error) {\n        alert('Error al eliminar usuario: ' + error.message);\n      }\n    };\n\n    return () => {\n      delete window.verModal;\n      delete window.editarModal;\n      delete window.deleteUser;\n    };\n  }, [verModal, editarModal, loadUsuarios]);\n\n  // Cargar usuario actual y verificar permisos\n   useEffect(() => {\n     const loadCurrentUser = async () => {\n       try {\n         console.log('🔐 Verificando permisos de administrador...');\n         // Verificar si tiene permisos de administrador\n         const hasPermission = await dbService.hasPermission(ROLES.ADMINISTRADOR);\n         console.log('✅ Permisos de administrador obtenidos:', hasPermission);\n         setCanEdit(hasPermission);\n         console.log('🎯 canEdit establecido como:', hasPermission);\n       } catch (err) {\n         console.error('❌ Error cargando permisos:', err);\n         setCanEdit(false);\n       }\n     };\n\n     loadCurrentUser();\n     loadUsuarios();\n   }, [loadUsuarios]);\n\n  // Filtrar usuarios\n  const filteredUsuarios = useMemo(() => {\n    const safeUsuarios = Array.isArray(usuarios) ? usuarios : [];\n    let filtered = safeUsuarios;\n\n    if (filtros.rol !== \"Todos\") {\n      filtered = filtered.filter(u => (u.rol || u.role) === filtros.rol);\n    }\n    if (filtros.busqueda) {\n      filtered = filtered.filter(u =>\n        (u.email || '').toLowerCase().includes(filtros.busqueda.toLowerCase())\n      );\n    }\n    return filtered;\n  }, [usuarios, filtros]);\n\n  // Estadísticas\n  const statsData = useMemo(() => [\n    {\n      title: \"Total Usuarios\",\n      value: filteredUsuarios.length,\n      icon: \"fas fa-users\",\n      color: \"blue\"\n    }\n  ], [filteredUsuarios]);\n\n  if (loading) {\n    return (\n      <DashboardLayout title=\"Usuarios\" subtitle=\"Gestión de usuarios\" loading={true} loadingText=\"Cargando usuarios...\" />\n    );\n  }\n\n  if (error) {\n    return (\n      <DashboardLayout title=\"Usuarios\" subtitle=\"Error al cargar datos\" loading={false}>\n        <div className=\"flex items-center justify-center h-screen\">\n          <div className=\"bg-red-50 border border-red-200 rounded-lg p-4\">\n            <p className=\"text-red-600\">Error loading usuarios del sistema: {error}</p>\n          </div>\n        </div>\n      </DashboardLayout>\n    );\n  }\n\n  // Verificar permisos de acceso a la página\n  if (!canEdit) {\n    return (\n      <DashboardLayout title=\"Usuarios\" subtitle=\"Acceso denegado\">\n        <div className=\"flex items-center justify-center h-screen\">\n          <div className=\"bg-yellow-50 border border-yellow-200 rounded-lg p-8 text-center max-w-md\">\n            <i className=\"fas fa-lock text-yellow-600 text-5xl mb-4\"></i>\n            <h3 className=\"text-xl font-semibold text-gray-900 mb-2\">Acceso Denegado</h3>\n            <p className=\"text-gray-600\">No tienes permisos para acceder a esta página. Solo los administradores pueden gestionar usuarios.</p>\n          </div>\n        </div>\n      </DashboardLayout>\n    );\n  }\n\n  const filterConfig = [\n    {\n      type: 'select',\n      name: 'rol',\n      label: 'Rol',\n      options: [\n        { value: 'Todos', label: 'Todos los Roles' },\n        { value: ROLES.ADMINISTRADOR, label: 'Administrador' },\n        { value: ROLES.CONSULTA, label: 'Consulta' }\n      ]\n    },\n    {\n      type: 'search',\n      name: 'busqueda',\n      label: 'Búsqueda',\n      placeholder: 'Buscar por email...'\n    }\n  ];\n\n  return (\n    <DashboardLayout\n      title=\"Gestión de Usuarios del sistema\"\n      subtitle=\"Administra los usuarios del sistema\"\n      extraActions={\n        canEdit && (\n          <button\n            onClick={() => crearModal.openModal()}\n            className=\"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors\"\n          >\n            <i className=\"fas fa-plus mr-2\"></i>\n            Nuevo Usuario\n          </button>\n        )\n      }\n    >\n      <section className=\"px-6 py-6\">\n        <FilterBar\n          filters={filterConfig}\n          values={filtros}\n          onChange={setFilter}\n          onClear={clearFilters}\n          showClearButton={true}\n        />\n\n        {/* Estadísticas Rápidas */}\n        <div className=\"mt-6\">\n          <StatsGrid\n            stats={statsData}\n            columns={3}\n            gap=\"md\"\n          />\n        </div>\n\n        {/* Tabla de Usuarios */}\n        <div className=\"mt-6\">\n        <div className=\"bg-white rounded-lg shadow-sm border border-gray-200\">\n          <div className=\"p-6 border-b border-gray-200\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <h3 className=\"text-lg font-semibold text-gray-800\">Lista de Usuarios del sistema</h3>\n                <p className=\"text-sm text-gray-600 mt-1\">\n                  Gestiona los usuarios del sistema\n                </p>\n              </div>\n              {canEdit ? (\n                <span className=\"inline-flex items-center px-3 py-1.5 rounded-full text-sm font-medium bg-green-100 text-green-800\">\n                  <i className=\"fas fa-user-shield mr-2\"></i>\n                  Modo Administrador\n                </span>\n              ) : (\n                <span className=\"inline-flex items-center px-3 py-1.5 rounded-full text-sm font-medium bg-yellow-100 text-yellow-800\">\n                  <i className=\"fas fa-eye mr-2\"></i>\n                  Modo Solo Lectura\n                </span>\n              )}\n            </div>\n          </div>\n\n          {filteredUsuarios.length === 0 ? (\n            <div className=\"p-12 text-center\">\n              <i className=\"fas fa-users text-gray-300 text-4xl mb-4\"></i>\n              <h3 className=\"text-lg font-medium text-gray-900 mb-2\">No se encontraron usuarios del sistema</h3>\n              <p className=\"text-gray-500\">No hay usuarios que coincidan con los filtros aplicados.</p>\n            </div>\n          ) : (\n            <DataTable\n              columns={[\n                {\n                  key: 'email',\n                  header: 'Email',\n                  render: (usuario) => (\n                    <div className=\"flex items-center\">\n                      <div className=\"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center mr-3\">\n                        <i className=\"fas fa-user text-blue-600\"></i>\n                      </div>\n                      <div>\n                        <p className=\"font-medium text-gray-900\">{usuario.email}</p>\n                        <p className=\"text-sm text-gray-500\">ID: {usuario.id_usuario || usuario.id}</p>\n                      </div>\n                    </div>\n                  )\n                },\n                {\n                  key: 'rol',\n                  header: 'Rol',\n                  render: (usuario) => {\n                    const userRole = usuario.rol || usuario.role;\n                    return (\n                      <span className={`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${\n                        userRole === ROLES.ADMINISTRADOR || userRole === 'ADMINISTRADOR'\n                          ? 'bg-purple-100 text-purple-800'\n                          : 'bg-green-100 text-green-800'\n                      }`}>\n                        <i className={`fas ${\n                          userRole === ROLES.ADMINISTRADOR || userRole === 'ADMINISTRADOR' ? 'fa-user-shield' : 'fa-user'\n                        } mr-2`}></i>\n                        {userRole === ROLES.ADMINISTRADOR || userRole === 'ADMINISTRADOR' ? 'Administrador' : 'Consulta'}\n                      </span>\n                    );\n                  }\n                },\n                {\n                  key: 'acciones',\n                  header: 'Acciones',\n                  render: (usuario) => {\n                    console.log('🔍 Renderizando acciones para usuario:', usuario.email, 'canEdit:', canEdit);\n\n                    if (canEdit) {\n                      console.log('🎯 Renderizando ActionDropdown para:', usuario.email);\n                      const userRole = usuario.rol || usuario.role;\n                      const isAdmin = userRole === ROLES.ADMINISTRADOR || userRole === 'ADMINISTRADOR';\n\n                      return (\n                        <div className=\"flex items-center space-x-2\">\n                          {!isAdmin && (\n                            <button\n                              onClick={() => {\n                                console.log('✏️ Editar usuario:', usuario.email);\n                                editarModal.openModal('edit', usuario);\n                              }}\n                              className=\"text-blue-600 hover:text-blue-800 p-2 rounded-lg hover:bg-blue-50 transition-colors\"\n                              title=\"Editar usuario\"\n                            >\n                              <i className=\"fas fa-edit\"></i>\n                            </button>\n                          )}\n                          {!isAdmin && (\n                            <button\n                              onClick={() => {\n                                console.log('🗑️ Eliminar usuario:', usuario.email);\n                                if (window.confirm('¿Estás seguro de que quieres eliminar este usuario?')) {\n                                  window.deleteUser && window.deleteUser(usuario.id_usuario || usuario.id);\n                                }\n                              }}\n                              className=\"text-red-600 hover:text-red-800 p-2 rounded-lg hover:bg-red-50 transition-colors\"\n                              title=\"Eliminar usuario\"\n                            >\n                              <i className=\"fas fa-trash\"></i>\n                            </button>\n                          )}\n                          {isAdmin && (\n                            <span className=\"text-xs text-gray-500 font-medium px-2 py-1 bg-gray-100 rounded\">\n                              <i className=\"fas fa-shield-alt mr-1\"></i>\n                              Protegido\n                            </span>\n                          )}\n                        </div>\n                      );\n                    } else {\n                      return (\n                        <div className=\"flex items-center space-x-2\">\n                          <button\n                            onClick={() => {\n                              console.log('👁️ Abriendo modal de solo lectura para:', usuario.email);\n                              verModal.openModal('view', usuario);\n                            }}\n                            className=\"text-blue-600 hover:text-blue-800 text-sm font-medium\"\n                          >\n                            <i className=\"fas fa-eye mr-1\"></i>\n                            Ver Detalles\n                          </button>\n                          <span className=\"text-xs text-yellow-600 font-medium\">\n                            <i className=\"fas fa-lock mr-1\"></i>\n                            Solo Lectura\n                          </span>\n                        </div>\n                      );\n                    }\n                  }\n                }\n              ]}\n              data={filteredUsuarios}\n              keyExtractor={(usuario) => usuario.id_usuario || usuario.id}\n              loading={loading}\n            />\n          )}\n        </div>\n        </div>\n      </section>\n\n      {/* Modales */}\n      <ViewDetailsModal\n        isOpen={verModal.isOpen}\n        onClose={verModal.closeModal}\n        title=\"Detalles del Usuario del sistema\"\n        data={verModal.modalData ? [\n          { label: 'ID', value: verModal.modalData.id_usuario || verModal.modalData.id },\n          { label: 'Email', value: verModal.modalData.email },\n          {\n            label: 'Contraseña',\n            value: '••••••••',\n            helperText: 'La contraseña está oculta por seguridad'\n          },\n          {\n            label: 'Rol',\n            value: (() => {\n              const rol = verModal.modalData.rol || verModal.modalData.role;\n              // Comparación más robusta\n              if (rol === ROLES.ADMINISTRADOR || rol === 'ADMINISTRADOR') {\n                return 'Administrador';\n              }\n              return 'Consulta';\n            })()\n          },\n          {\n            label: 'Fecha de creación',\n            value: new Date(verModal.modalData.created_at).toLocaleString('es-ES')\n          },\n          {\n            label: 'Última actualización',\n            value: new Date(verModal.modalData.updated_at).toLocaleString('es-ES')\n          }\n        ] : []}\n      />\n\n      <EditFormModal\n        isOpen={editarModal.isOpen}\n        onClose={editarModal.closeModal}\n        title=\"Editar Usuario del sistema\"\n        onSubmit={async (formData) => {\n          // Validar email\n          const emailValidation = validateEmail(formData.email);\n          if (!emailValidation.isValid) {\n            throw new Error(emailValidation.error);\n          }\n\n          // Validar rol\n          if (!formData.rol || (formData.rol !== ROLES.ADMINISTRADOR && formData.rol !== ROLES.CONSULTA && formData.rol !== 'ADMINISTRADOR' && formData.rol !== 'CONSULTA')) {\n            throw new Error('Rol inválido');\n          }\n\n          // Si no se proporciona password, no lo incluimos en la actualización\n          const updateData = {\n            email: formData.email,\n            role: formData.rol // El backend espera 'role', no 'rol'\n          };\n\n          if (formData.password && formData.password.trim()) {\n            if (formData.password.length < 8) {\n              throw new Error('La contraseña debe tener al menos 8 caracteres');\n            }\n            updateData.password = formData.password;\n          }\n\n          const result = await dbService.updateUsuario(editarModal.modalData.id_usuario || editarModal.modalData.id, updateData);\n          if (result.error) {\n            throw new Error(result.error.message || 'Error al actualizar usuario');\n          }\n          await loadUsuarios();\n        }}\n        initialData={editarModal.modalData ? {\n          email: editarModal.modalData.email,\n          password: '',\n          rol: editarModal.modalData.rol || editarModal.modalData.role\n        } : {\n          email: '',\n          password: '',\n          rol: ROLES.CONSULTA\n        }}\n        fields={[\n          {\n            name: 'email',\n            label: 'Email',\n            type: 'email',\n            required: true,\n            placeholder: 'usuario@ejemplo.com'\n          },\n          {\n            name: 'currentPassword',\n            label: 'Contraseña Actual (solo lectura)',\n            type: 'password',\n            readOnly: true,\n            placeholder: 'Contraseña actual del usuario',\n            value: '••••••••', // Mostrar puntos por seguridad\n            helperText: 'La contraseña actual no se puede ver por seguridad'\n          },\n          {\n            name: 'password',\n            label: 'Nueva Contraseña (opcional)',\n            type: 'password',\n            placeholder: 'Dejar en blanco para mantener la actual',\n            helperText: 'Mínimo 8 caracteres. Si se deja en blanco, mantiene la contraseña actual.'\n          },\n          {\n            name: 'rol',\n            label: 'Rol',\n            type: 'select',\n            required: true,\n            options: [\n              { value: ROLES.CONSULTA, label: 'Consulta' }\n            ]\n          }\n        ]}\n      />\n\n      <CreateFormModal\n        isOpen={crearModal.isOpen}\n        onClose={crearModal.closeModal}\n        title=\"Nuevo Usuario del sistema\"\n        onSubmit={async (formData) => {\n          // Validar email\n          const emailValidation = validateEmail(formData.email);\n          if (!emailValidation.isValid) {\n            throw new Error(emailValidation.error);\n          }\n\n          // Validar password\n          if (!formData.password || formData.password.length < 8) {\n            throw new Error('La contraseña debe tener al menos 8 caracteres');\n          }\n\n          // Validar rol\n          if (!formData.rol || (formData.rol !== ROLES.ADMINISTRADOR && formData.rol !== ROLES.CONSULTA && formData.rol !== 'ADMINISTRADOR' && formData.rol !== 'CONSULTA')) {\n            throw new Error('Rol inválido');\n          }\n\n          // Convertir 'rol' a 'role' para el backend\n          const userData = {\n            email: formData.email,\n            password: formData.password,\n            role: formData.rol\n          };\n\n          const result = await dbService.createUsuario(userData);\n          if (result.error) {\n            throw new Error(result.error.message || 'Error al crear usuario');\n          }\n          await loadUsuarios();\n        }}\n        initialData={{\n          email: '',\n          password: '',\n          rol: ROLES.CONSULTA\n        }}\n        fields={[\n          {\n            name: 'email',\n            label: 'Email',\n            type: 'email',\n            required: true,\n            placeholder: 'usuario@ejemplo.com'\n          },\n          {\n            name: 'password',\n            label: 'Contraseña',\n            type: 'password',\n            required: true,\n            placeholder: 'Mínimo 8 caracteres',\n            helperText: 'Mínimo 8 caracteres. La contraseña debe ser segura.'\n          },\n          {\n            name: 'rol',\n            label: 'Rol',\n            type: 'select',\n            required: true,\n            options: [\n              { value: ROLES.ADMINISTRADOR, label: 'Administrador' },\n              { value: ROLES.CONSULTA, label: 'Consulta' }\n            ]\n          }\n        ]}\n      />\n    </DashboardLayout>\n  );\n};\n\n// Wrap with React.memo to prevent unnecessary re-renders\nconst Usuarios = React.memo(UsuariosComponent);\n\nexport default Usuarios;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}